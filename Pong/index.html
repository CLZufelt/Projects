<html>
<head>
<link rel="shortcut icon" href="favicon.ico" type="image/ico"/>
<script type="application/javascript">

var canvas = null;
var ctx = null;

var canvas_left = 0;
var canvas_right = 500;
var canvas_top = 0;
var canvas_bottom = 500;

var paddle_height = 50;
var paddle_width = 10;

var puck_height = 10;
var puck_width = 10;

var x = 0;
var y = 0;

var why1 = 0;
var why2 = 0;

var speed_on_x_axis = 0;
var speedy = 0;

var right_paddle_speed = 0;
var left_paddle_speed = 0;

var game_in_progress = false;

function init() {
  canvas = document.getElementById('pong');
  ctx = canvas.getContext('2d');
  game_ready();
  draw();
}

function game_ready() {
  x = canvas_right / 2;
  y = canvas_bottom / 2;

  why1 = (canvas_bottom / 2) - (paddle_height / 2);
  why2 = why1;
}

function draw() {
  clear_screen();
  draw_paddles();
  draw_puck();
  setTimeout(draw, 5);
}

function draw_paddles() {
  ctx.fillStyle = "rgb(80,80,80)";
  why1 += left_paddle_speed;
  if (why1 >= 450) {
    why1 = 450;
  } else if (why1 <= 0) {
    why1 = 0;
  }
  ctx.fillRect(0,why1,10,50);
  
  ctx.fillStyle = "rgb(80,80,80)";
  why2 += right_paddle_speed;
  if (why2 >= 450) {
    why2 = 450;
  } else if (why2 <= 0) {
    why2 = 0;
  }
  ctx.fillRect(490,why2,10,50);
  //console.log(why2)
}

//function speed(speed_on_x_axis, speedy) {
//  
//}


function keypress(event, direction) { 
  var keydown = String.fromCharCode(event.keyCode)
  if (keydown === " " && game_in_progress === false) {
    speed_on_x_axis = (Math.random() * 2) -1;
    speedy = (Math.random()* 2) -1;
    var velocity = Math.sqrt(speed_on_x_axis * speed_on_x_axis + speedy * speedy);
    speed_on_x_axis = speed_on_x_axis / velocity;
    speedy = speedy / velocity;
    velocity = Math.sqrt(speed_on_x_axis * speed_on_x_axis + speedy * speedy);
    game_in_progress = true
  }
  if (keydown === "S" && direction === "down") {
    left_paddle_speed = 1;
  }
  if (keydown === "S" && direction === "up") {
    left_paddle_speed = 0;
  }
  if (keydown === "A" && direction === "down") {
    left_paddle_speed = -1;
  }
  if (keydown === "A" && direction === "up") {
    left_paddle_speed = 0;
  }
  if (keydown === "L" && direction === "down") {
    right_paddle_speed = 1;
  }
  if (keydown === "L" && direction === "up") {
    right_paddle_speed = 0;
  }
  if (keydown === "K" && direction === "down") {
    right_paddle_speed = -1;
  }
  if (keydown === "K" && direction === "up") {
    right_paddle_speed = 0;
  }
}

function draw_puck() {
  ctx.fillStyle = "rgb(0,0,0)";
  ctx.fillRect(x,y,10,10);
  bounce_lose();
  if (x <= 0) {
    speed_on_x_axis = 0;
    speedy = 0;
  }
  if (y <= 0) {
    speedy = 1;
  }
  if (x >= 490) {
    speed_on_x_axis = 0;
    speedy = 0;
  }
  if (y >= 490) {
    speedy = -1;
  }
  x += speed_on_x_axis;
  y += speedy;
}

function bounce_lose() {
  var right_paddle_bottom = why2;
  var right_paddle_top = why2 + 50;
  var left_paddle_bottom = why1;
  var left_paddle_top = why1 + 50;
  if (x <= 10) {
    if (y >= (left_paddle_bottom) && y <= (left_paddle_top)) {
      speed_on_x_axis = 1;
      speedy = 1;
    }
  } else if (x >= 480) {
      if (y >= (right_paddle_bottom) && y <= (right_paddle_top)) {
        speed_on_x_axis = -1;
        speedy = -1;
      }
    }
}


function clear_screen() {
  ctx.fillStyle = "rgb(255, 255, 255)";
  ctx.fillRect(0,0,500,500);
}

</script>

</head>
<body onkeydown="keypress(event, 'down');" onkeyup="keypress(event, 
'up');" onload="init();">

<canvas id="pong" style="border: 1px solid black;" width="500" height="500"></canvas>

</body>
</html>
